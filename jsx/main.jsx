// alert("so...");var docRef = app.activeDocument;var newFile = function (x, y){    app.preferences.rulerUnits = Units.PIXELS    var docRef = app.documents.add (x, y, 72, "NewFile", NewDocumentMode.RGB, DocumentFill.WHITE);    docRef.channels.add();    docRef.activeChannels = new Array(docRef.channels[0], docRef.channels[1], docRef.channels[2])}var newLayerSet = function (name){    var docRef = app.activeDocument;    var setRef = docRef.layerSets.add();    setRef.name = name;}var structure = function (){    newLayerSet("Roughness");    newLayerSet("Metal");    newLayerSet("Normal");    newLayerSet("Ambient Occlusion");    newLayerSet("Color");}//newFile(1000,1000);//var c = app.activeDocument.channels.getByName ("Blue")var docRef = app.activeDocument;//docRef.activeChannels = new Array(docRef.channels[0], docRef.channels[1], docRef.channels[2])//docRef.activeLayer = docRef.layers["Metal"]var newExpLayer = function(layerName){    var docRef = app.activeDocument;    var expLayer = docRef.artLayers.add(DocumentFill.WHITE);    expLayer.name = layerName;    docRef.selection.fill (RGBColor)    expLayer.DocumentFill = DocumentFill.TRANSPARENT;    return expLayer}var flatSet = function(setName){    var docRef = app.activeDocument;    docRef.activeLayer = docRef.layers[setName];    var newSet = docRef.activeLayer.duplicate ();    var mergedNewSet = newSet.merge();    mergedNewSet.name = setName + "_flatSet";    docRef.activeLayer = mergedNewSet;    return mergedNewSet;}var copyPaste = function(fromLayer, fromChannel, toLayer, toChannel){    docRef.activeLayer = fromLayer    docRef.activeChannels = new Array(docRef.channels[fromChannel])    docRef.selection.selectAll()    docRef.selection.copy ()    docRef.activeLayer = toLayer    docRef.activeChannels = new Array(docRef.channels[toChannel])    docRef.paste ();    docRef.selection.deselect()}var expCA = function(){    var ca = newExpLayer ("ColorAO_exp")    var colorFlat = flatSet ("Color")    copyPaste (colorFlat, "Red",ca , "Red")    copyPaste (colorFlat, "Green",ca , "Green")    copyPaste (colorFlat, "Blue",ca , "Blue")    var AOFlat = flatSet ("Ambient Occlusion")    copyPaste (AOFlat, "Red",ca , "Alpha 1")    colorFlat.remove()    AOFlat.remove()}var expNMR = function(){    var nmr = newExpLayer ("NMR_exp")    var normalFlat = flatSet ("Normal")    copyPaste (normalFlat, "Red",nmr , "Red")    copyPaste (normalFlat, "Green",nmr, "Green")    var MetalFlat = flatSet ("Metal")    copyPaste (MetalFlat, "Red",nmr , "Blue")    var RoughnessFlat = flatSet ("Roughness")    copyPaste (RoughnessFlat, "Red",nmr , "Alpha 1")    normalFlat.remove()    MetalFlat.remove()    RoughnessFlat.remove()}